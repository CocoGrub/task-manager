(this["webpackJsonptasks-list-test"]=this["webpackJsonptasks-list-test"]||[]).push([[0],{95:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a(0),r=a(18),s=a.n(r),i=(a(67),a(4)),o=a(8),l=a(9),u=a(16),j=function(e){var t=e.email,a=e.id,c=e.status,r=e.text,s=e.username,i=e.isLogin;return Object(n.jsx)("div",{className:"col-sm-4 ",children:Object(n.jsx)("div",{className:"card",children:Object(n.jsxs)("div",{className:"card-body",children:[Object(n.jsxs)("div",{className:"card-title",children:[Object(n.jsx)("h4",{children:s}),Object(n.jsx)("h6",{children:t})]}),Object(n.jsx)("p",{className:"card-text",children:r.edited?r.edited:r.original}),Object(n.jsxs)("div",{className:"float-right",children:[c>0&&Object(n.jsx)("span",{className:"badge badge-success",children:"\u0412\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u043e"}),Object(n.jsx)("br",{}),r.edited&&Object(n.jsx)("span",{className:"badge badge-secondary",children:"\u0418\u0437\u043c\u0435\u043d\u0435\u043d"})]}),i&&Object(n.jsx)(u.b,{className:"btn btn-primary",to:{pathname:"/task/"+a,state:{email:t,id:a,status:c,text:r,username:s,isLogin:i}},children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})]})})})},b=a(22),d=function(e){for(var t=e.itemsPerPage,a=void 0===t?3:t,r=e.itemsTotal,s=e.setPage,i=e.currentPage,l=Object(o.b)(),u=Object(c.useState)(1),j=Object(b.a)(u,2),d=j[0],m=j[1],O=(d-1)*a+1,p=d*a,h=Math.ceil(r/a),f=[],x=1;x<=Math.ceil(r/a);x++)f.push(x);var g=Math.ceil(h/a);return Object(n.jsx)("div",{className:"align-self-center",style:{marginTop:"2em",alignSelf:"center"},children:Object(n.jsxs)("ul",{className:"pagination",children:[d>1&&Object(n.jsx)("button",{className:"btn btn-outline-info",onClick:function(){l({type:"SET_PAGE_NUMBER",payload:O-1}),m(d-1)},children:"PREV"}),f.filter((function(e){return e>=O&&e<=p})).map((function(e){return Object(n.jsx)("li",{className:i===e?"page-item active":" page-item",style:{cursor:"pointer"},onClick:function(){s(e)},children:Object(n.jsx)("span",{className:"page-link",children:e})},e)})),g>d&&Object(n.jsx)("button",{className:"btn btn-outline-info",onClick:function(){m(d+1),l({type:"SET_PAGE_NUMBER",payload:p+1})},children:"NEXT"})]})})},m=a(17),O=a.n(m),p=a(30),h=a(56),f=a.n(h),x="developer=Fedor.",g=function(e){var t=f.a.create({baseURL:"https://uxcandy.com/~shapoval/test-task-backend/v2"});return e&&(t.defaults.headers.common["Content-Type"]="multipart/form-data"),t},v=function(e){for(var t=new FormData,a=0;a<Object.keys(e).length;a++)t.append("".concat(Object.keys(e)[a]),"".concat(e[Object.keys(e)[a]]));return g(1).post("/login?".concat(x),t).then((function(e){return e.data})).catch((function(e){return e}))},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"id",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"desc",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"1";return g().get("?".concat(x,"&sort_field=").concat(e,"&sort_direction=").concat(t,"&page=").concat(a)).then((function(e){return{res:e,page:a}})).catch((function(e){return e}))},N=function(e){return g(1).post("/create?".concat(x),e).then((function(e){return e})).catch((function(e){return e}))},y=function(e){var t=e.token,a=e.id,n=e.text,c=e.status,r=new FormData;return r.set("token",t),r.set("text",n),r.set("status",c),g(1).post("/edit/".concat(a,"?").concat(x),r).then((function(e){return e.data}))},E=function(e,t,a){var n="";if(a){var c=new Date;c.setTime(c.getTime()+1e3*a),n="; expires="+c.toGMTString()}document.cookie=e+"="+t+n+"; path=/"},_=function(e,t,a){return function(){var n=Object(p.a)(O.a.mark((function n(c){var r,s,i,o,l,u;return O.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=function(e){return(new DOMParser).parseFromString(e,"text/html").documentElement.textContent},n.prev=1,n.next=4,k(e,t,a);case 4:for(s=n.sent,i=s.res.data.message.tasks,o=0;o<i.length;o++)-1!==i[o].text.search(/{(.*?)}/)?(l=JSON.parse(r(i[o].text)).original,u=JSON.parse(r(i[o].text)).edited,s.res.data.message.tasks[o].text={original:l,edited:u}):s.res.data.message.tasks[o].text={original:i[o].text};c({type:"LOAD_TASKS",payload:s}),n.next=13;break;case 10:n.prev=10,n.t0=n.catch(1),console.log(n.t0);case 13:case"end":return n.stop()}}),n,null,[[1,10]])})));return function(e){return n.apply(this,arguments)}}()},T=function(){return function(e){var t=function(e){for(var t=e+"=",a=document.cookie.split(";"),n=0;n<a.length;n++){for(var c=a[n];" "===c.charAt(0);)c=c.substring(1,c.length);if(0===c.indexOf(t))return c.substring(t.length,c.length)}return null}("token");t&&localStorage.setItem("token",t),localStorage.getItem("token")&&e({type:"LOG_IN"})}},S=function(){return function(e){localStorage.removeItem("token"),E("token","",-1),e({type:"LOG_OUT"})}},R=Object(n.jsx)("div",{className:"alert alert-success",role:"alert",style:{width:"30%",alignSelf:"center",display:"flex",justifyContent:"center"},children:"\u0417\u0430\u0434\u0430\u0447\u0430 \u0431\u044b\u043b\u0430 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0430!"}),C=function(e){var t=Object(o.b)(),a=Object(o.c)((function(e){return e.currentPage})),r=Object(o.c)((function(e){return e.items})),s=Object(o.c)((function(e){return e.isLogin})),l=Object(o.c)((function(e){return e.task_created})),u=Object(o.c)((function(e){return e.total_task_count})),b=Object(o.c)((function(e){return e.filter})),m=Object.keys(b)[0],O=b[m];Object(c.useEffect)((function(){t(_(m,O,a))}),[t,e.history.location.pathname,m,O,a]);return Object(n.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[l&&R,Object(n.jsx)("div",{className:"row",children:r.map((function(e,t){return Object(n.jsx)(j,Object(i.a)(Object(i.a)({},e),{},{isLogin:s}),t)}))}),Object(n.jsx)(d,{currentPage:a,setPage:function(e){t(_(m,O,e))},itemsTotal:u})]})},w=a(21),L=a(102),I=a(103),D=a(101),A=function(){var e=Object(o.b)(),t=Object(o.c)((function(e){return e.isLogin})),a=function(t){var a;e((a=Object(w.a)({},t.target.name,t.target.value),function(){var e=Object(p.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t({type:"SET_FILTER",payload:a});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))};return Object(n.jsxs)(L.a,{collapseOnSelect:!0,expand:"lg",bg:"dark",variant:"dark",children:[Object(n.jsx)(L.a.Brand,{children:Object(n.jsx)(u.c,{to:"/",className:"navbar-brand",children:"\u041d\u0430 \u0433\u043b\u0430\u0432\u043d\u0443\u044e"})}),Object(n.jsx)(L.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),Object(n.jsxs)(L.a.Collapse,{id:"responsive-navbar-nav",children:[Object(n.jsxs)(I.a,{className:"mr-auto",children:[Object(n.jsx)(u.c,{to:"/createTask",activeClassName:"active",className:"nav-link","aria-current":"page",children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443"}),Object(n.jsxs)(D.a,{title:"\u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430",id:"collasible-nav-dropdown",children:[Object(n.jsx)(D.a.Item,{children:Object(n.jsx)("button",{name:"username",value:"desc",onClick:a,className:"dropdown-item",children:"\u041f\u043e \u0438\u043c\u0435\u043d\u0438 \u2193"})}),Object(n.jsx)(D.a.Item,{children:Object(n.jsx)("button",{name:"username",value:"asc",onClick:a,className:"dropdown-item",children:"\u041f\u043e \u0438\u043c\u0435\u043d\u0438 \u2191"})}),Object(n.jsx)(D.a.Divider,{}),Object(n.jsx)(D.a.Item,{children:Object(n.jsx)("button",{name:"email",value:"desc",onClick:a,className:"dropdown-item",children:"\u041f\u043e email \u2193"})}),Object(n.jsx)(D.a.Item,{children:Object(n.jsx)("button",{name:"email",value:"asc",onClick:a,className:"dropdown-item",children:"\u041f\u043e email \u2191"})}),Object(n.jsx)(D.a.Divider,{}),Object(n.jsx)(D.a.Item,{children:Object(n.jsx)("button",{name:"status",value:"desc",onClick:a,className:"dropdown-item",children:"\u041f\u043e \u0441\u0442\u0430\u0442\u0443\u0441\u0443 \u2193"})}),Object(n.jsx)(D.a.Item,{children:Object(n.jsx)("button",{name:"status",value:"asc",onClick:a,className:"dropdown-item",children:"\u041f\u043e \u0441\u0442\u0430\u0442\u0443\u0441\u0443 \u2191"})})]})]}),t?Object(n.jsx)(u.c,{onClick:function(){e(S())},to:"/logIn",activeClassName:"active",className:"nav-link","aria-current":"page",children:"\u0412\u044b\u0439\u0442\u0438"}):Object(n.jsx)(u.c,{to:"/logIn",activeClassName:"active",className:"nav-link","aria-current":"page",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})},P=function(e){var t=e.history,a=Object(o.b)(),r=Object(c.useState)({username:"",email:"",text:""}),s=Object(b.a)(r,2),l=s[0],u=s[1],j=l.username,d=l.email,m=l.text,h=function(e){u(Object(i.a)(Object(i.a)({},l),{},Object(w.a)({},e.target.name,e.target.value)))};return Object(n.jsx)("div",{children:Object(n.jsxs)("form",{onSubmit:function(e){e.preventDefault();var n,c=new FormData;c.set("username",j),c.set("email",d),c.set("text",JSON.stringify({original:m})),a((n=c,function(){var e=Object(p.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,N(n);case 3:t({type:"TASK_CREATED"}),setTimeout((function(){t({type:"TASK_CREATED_CLOSE"})}),3e3),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}())),t.push("/")},children:[Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{htmlFor:"username",children:"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"}),Object(n.jsx)("input",{required:!0,value:j,onChange:h,type:"text",className:"form-control",name:"username","aria-describedby":"username",placeholder:"Enter username"})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{htmlFor:"email",children:"\u041f\u043e\u0447\u0442\u043e\u0432\u044b\u0439 \u0430\u0434\u0440\u0435\u0441"}),Object(n.jsx)("input",{required:!0,value:d,onChange:h,type:"email",className:"form-control",name:"email","aria-describedby":"email",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u043e\u0447\u0442\u043e\u0432\u044b\u0439 \u0430\u0434\u0440\u0435\u0441\u0441"})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{htmlFor:"text",children:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435"}),Object(n.jsx)("input",{required:!0,value:m,onChange:h,type:"text",className:"form-control",name:"text","aria-describedby":"text",placeholder:"text"})]}),Object(n.jsx)("button",{type:"submit",className:"btn btn-primary",children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]})})},G=function(e){var t=Object(o.b)(),a=Object(c.useState)(Object(i.a)({},e.location.state)),r=Object(b.a)(a,2),s=r[0],l=r[1],u=s.username,j=s.email,d=s.text,m=s.status,h=s.id;return Object(n.jsx)("div",{children:Object(n.jsxs)("form",{onSubmit:function(a){if(a.preventDefault(),localStorage.getItem("token")){console.log("aa");var n={id:h,status:s.status,text:JSON.stringify({original:d.original,edited:d.edited})};t(function(e){var t=e.id,a=e.text,n=e.status;return Object(p.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y({token:localStorage.getItem("token"),id:t,text:a,status:n});case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}}),e,null,[[0,5]])})))}(n)),e.history.push("/")}else t(S()),e.history.push("/logIn"),t((function(e){e({type:"EDIT_TASK_ERROR"}),setTimeout((function(){e({type:"EDIT_TASK_ERROR"})}),3e3)}))},children:[Object(n.jsx)("div",{className:"form-group",children:Object(n.jsx)("p",{className:"form-control",children:u})}),Object(n.jsx)("div",{className:"form-group",children:Object(n.jsx)("p",{className:"form-control",children:j})}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{htmlFor:"text",children:"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435"}),Object(n.jsx)("input",{value:d.edited?d.edited:d.original,onChange:function(e){l(Object(i.a)(Object(i.a)({},s),{},{text:Object(i.a)(Object(i.a)({},s.text),{},{edited:e.target.value})}))},type:"text",className:"form-control",name:"text","aria-describedby":"text",placeholder:"text"})]}),Object(n.jsx)("div",{className:"form-group",children:Object(n.jsx)("div",{className:"form-check-inline",children:Object(n.jsxs)("label",{className:"form-check-label",children:[Object(n.jsx)("input",{checked:m,value:m,onChange:function(e){l(Object(i.a)(Object(i.a)({},s),{},{status:e.target.checked?10:0}))},type:"checkbox",className:"form-check-input"}),"\u0417\u0430\u0434\u0430\u0447\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0430"]})})}),Object(n.jsx)("button",{type:"submit",className:"btn btn-primary",children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]})})},F=function(e){var t=e.history,a=Object(o.b)(),r=Object(o.c)((function(e){return e.isLogin})),s=Object(o.c)((function(e){return e.createTaskError})),l=Object(o.c)((function(e){return e.loginError}));Object(c.useEffect)((function(){r&&t.push("/")}),[t,r]);var u=Object(c.useState)({username:"",password:""}),j=Object(b.a)(u,2),d=j[0],m=j[1],h=d.username,f=d.password,x=function(e){m(Object(i.a)(Object(i.a)({},d),{},Object(w.a)({},e.target.name,e.target.value)))};return Object(n.jsxs)("div",{children:[Object(n.jsxs)("form",{onSubmit:function(e){var t;e.preventDefault(),a((t=d,function(){var e=Object(p.a)(O.a.mark((function e(a){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v(t);case 3:"ok"===(n=e.sent).status?(a({type:"LOG_IN"}),void 0!==n.message.token&&(localStorage.setItem("token",n.message.token),E("token",n.message.token,86400))):(a({type:"LOG_IN_ERROR"}),setTimeout((function(){a({type:"LOG_IN_ERROR_CLOSE"})}),3e3)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()))},children:[Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{htmlFor:"username",children:"\u0418\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"}),Object(n.jsx)("input",{required:!0,value:h,onChange:x,type:"text",className:"form-control",name:"username","aria-describedby":"username",placeholder:"\u0432\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043c\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f"})]}),Object(n.jsxs)("div",{className:"form-group",children:[Object(n.jsx)("label",{htmlFor:"email",children:"\u041f\u0430\u0440\u043e\u043b\u044c"}),Object(n.jsx)("input",{required:!0,value:f,onChange:x,type:"password",className:"form-control",name:"password","aria-describedby":"password",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u043f\u0430\u0440\u043e\u043b\u044c"})]}),Object(n.jsx)("button",{type:"submit",className:"btn btn-primary",children:"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"})]}),l&&Object(n.jsx)("div",{style:{margin:"2em 0"},className:"alert alert-danger",role:"alert",children:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044b"}),s&&Object(n.jsx)("div",{style:{margin:"2em 0"},className:"alert alert-warning",role:"alert",children:"\u0412\u044b \u043d\u0435 \u0437\u0430\u043b\u043e\u0433\u0438\u043d\u0435\u043d\u044b!"})]})},U=a(61),K=function(e){var t=e.component,a=Object(U.a)(e,["component"]),c=Object(o.c)((function(e){return e.isLogin}));return Object(n.jsx)(l.b,Object(i.a)(Object(i.a)({},a),{},{render:function(e){return!0===c?Object(n.jsx)(t,Object(i.a)({},e)):Object(n.jsx)(l.a,{to:{pathname:"/login"}})}}))};var M=Object(l.h)((function(){var e=Object(o.b)(),t=Object(l.g)();return Object(c.useEffect)((function(){e(T())}),[e]),Object(c.useEffect)((function(){e({type:"SET_CURRENT_URL",payload:t.pathname})}),[t.pathname,e]),Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)(A,{}),Object(n.jsx)("div",{className:"container-fluid",style:{display:"flex",flexDirection:"column",marginTop:"2em",justifyContent:"center"},children:Object(n.jsxs)(l.d,{children:[Object(n.jsx)(l.b,{path:"/",exact:!0,render:function(e){return Object(n.jsx)(C,Object(i.a)({},e))}}),Object(n.jsx)(l.b,{path:"/createTask",render:function(e){return Object(n.jsx)(P,Object(i.a)({},e))}}),Object(n.jsx)(l.b,{path:"/logIn",render:function(e){return Object(n.jsx)(F,Object(i.a)({},e))}}),Object(n.jsx)(K,{path:"/task/:id",component:G})]})})]})})),J=a(59),q=a(26),B=a(60),V={currentURL:"",currentPage:1,loginError:null,createTaskError:!1,isLogin:!1,task_created:!1,total_task_count:0,items:[{username:"",email:"",text:"",status:"",id:""}],filter:{name:"desc"}},W=Object(q.createStore)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"LOAD_TASKS":return Object(i.a)(Object(i.a)({},e),{},{total_task_count:n.res.data.message.total_task_count,items:n.res.data.message.tasks,currentPage:n.page});case"SET_PAGE":return Object(i.a)(Object(i.a)({},e),{},{items:n.tasks,filter:Object(i.a)({},e.filter),currentPage:n.page});case"SET_PAGE_NUMBER":return Object(i.a)(Object(i.a)({},e),{},{currentPage:n});case"LOG_IN":return Object(i.a)(Object(i.a)({},e),{},{isLogin:!0,loginError:!1});case"LOG_IN_ERROR_CLOSE":return Object(i.a)(Object(i.a)({},e),{},{loginError:!1});case"LOG_OUT":return Object(i.a)(Object(i.a)({},e),{},{isLogin:!1});case"TASK_CREATED":return Object(i.a)(Object(i.a)({},e),{},{task_created:!0});case"TASK_CREATED_CLOSE":return Object(i.a)(Object(i.a)({},e),{},{task_created:!1});case"LOG_IN_ERROR":return Object(i.a)(Object(i.a)({},e),{},{loginError:!0});case"EDIT_TASK_ERROR":return Object(i.a)(Object(i.a)({},e),{},{createTaskError:!e.createTaskError});case"SET_FILTER":return Object(i.a)(Object(i.a)({},e),{},{filter:n});case"SET_CURRENT_URL":return Object(i.a)(Object(i.a)({},e),{},{currentURL:n});default:return e}}),Object(J.composeWithDevTools)(Object(q.applyMiddleware)(B.a)));s.a.render(Object(n.jsx)(u.a,{children:Object(n.jsx)(o.a,{store:W,children:Object(n.jsx)(M,{})})}),document.getElementById("root"))}},[[95,1,2]]]);
//# sourceMappingURL=main.04e517f1.chunk.js.map